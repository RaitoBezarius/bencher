---
title: "Google Benchmark"
description: "Um guia passo a passo sobre como fazer benchmark de c√≥digo C++ com Google Benchmark"
heading: "Como fazer benchmark de c√≥digo C++ com Google Benchmark"
published: "2024-11-03T16:30:00Z"
modified: "2024-11-03T16:30:00Z"
sortOrder: 1
---

import Benchmarking from "../../../chunks/benchmarking/pt/benchmarking.mdx";
import FizzBuzzRules from "../../../chunks/benchmarking/pt/fizz-buzz-rules.mdx";
import FizzBuzzCpp from "../../../chunks/benchmarking-cpp/pt/fizz-buzz-cpp.mdx";
import StepByStepCpp from "../../../chunks/benchmarking-cpp/pt/step-by-step-cpp.mdx";
import MicroVsMacro from "../../../chunks/benchmarking/pt/micro-vs-macro.mdx";
import BenchmarkingCpp from "../../../chunks/benchmarking-cpp/pt/benchmarking-cpp.mdx";
import FizzBuzzRefactor from "../../../chunks/benchmarking-cpp/google-benchmark/pt/fizz-buzz-refactor.mdx";
import BenchmarkingFizzBuzz from "../../../chunks/benchmarking-cpp/google-benchmark/pt/benchmarking-fizz-buzz.mdx";
import FizzBuzzFibonacciCpp from "../../../chunks/benchmarking-cpp/pt/fizz-buzz-fibonacci-cpp.mdx";
import PlayGameCode from "../../../chunks/benchmarking-cpp/google-benchmark/play-game-code.mdx";
import BenchmarkingFizzBuzzFibonacci from "../../../chunks/benchmarking-cpp/google-benchmark/pt/benchmarking-fizz-buzz-fibonacci.mdx";
import FizzBuzzFibonacciOpenCpp from "../../../chunks/benchmarking-cpp/google-benchmark/pt/fizz-buzz-fibonacci-open-cpp.mdx";
import FizzBuzzFibonacciOpenCode from "../../../chunks/benchmarking-cpp/fizz-buzz-fibonacci-open-code.mdx";
import TheEnd from "../../../chunks/benchmarking/pt/the-end.mdx";
import OnFire from "../../../chunks/benchmarking/pt/on-fire.mdx";
import TestGameOnFireCode from "../../../chunks/benchmarking-cpp/google-benchmark/benchmark-game-on-fire-code.mdx";
import BenchmarkGameOnFireOutputStart from "../../../chunks/benchmarking-cpp/google-benchmark/benchmark-game-on-fire-output-start.mdx";
import BenchmarkGameOnFireOutput from "../../../chunks/benchmarking-cpp/google-benchmark/benchmark-game-on-fire-output.mdx";
import FizzBuzzFibonacciFix from "../../../chunks/benchmarking-cpp/google-benchmark/pt/fizz-buzz-fibonacci-fix.mdx";
import BenchmarkGameFixOutput from "../../../chunks/benchmarking-cpp/google-benchmark/benchmark-game-fix-output.mdx";
import CatchInCi from "../../../chunks/benchmarking/pt/catch-in-ci.mdx";
import CatchInCiOutput from "../../../chunks/benchmarking-cpp/google-benchmark/catch-in-ci-output.mdx";
import CatchInCiPlot from "../../../chunks/benchmarking/pt/catch-in-ci-plot.mdx";
import CatchInCiPlotRustBench from "../../../chunks/benchmarking-rust/catch-in-ci-plot-rust-bench.mdx";
import BencherFooter from "../../../chunks/learn/pt/bencher-footer.mdx";

<Benchmarking />

<FizzBuzzCpp />

<StepByStepCpp />

<MicroVsMacro />

<BenchmarkingCpp />

Ambos s√£o [suportados pela Bencher](/pt/docs/explanation/adapters/).
Ent√£o, por que escolher o Google Benchmark?
O Google Benchmark integra-se perfeitamente com o GoogleTest,
que √© o padr√£o de fato para testes unit√°rios no ecossistema C++.
Eu sugiro usar o Google Benchmark para mensurar a lat√™ncia do seu c√≥digo,
especialmente se voc√™ j√° estiver usando o GoogleTest.
Ou seja, o Google Benchmark √© excelente para medir o tempo de execu√ß√£o total.

<FizzBuzzRefactor />

<BenchmarkingFizzBuzz />

<FizzBuzzFibonacciCpp>
  <PlayGameCode />
</FizzBuzzFibonacciCpp>

<BenchmarkingFizzBuzzFibonacci />

<FizzBuzzFibonacciOpenCpp>
    <FizzBuzzFibonacciOpenCode />
</FizzBuzzFibonacciOpenCpp>

<TheEnd />

<br />

<OnFire />

<TestGameOnFireCode />

- Um micro-benchmark `BENCHMARK_game_100` para jogar com o n√∫mero cem (`100`)
- Um micro-benchmark `BENCHMARK_game_1_000_000` para jogar com o n√∫mero um milh√£o (`1_000_000`)

Quando executei, obtive isso:

<BenchmarkGameOnFireOutputStart />

Espere por isso... espere por isso...

<BenchmarkGameOnFireOutput />

O qu√™! `1,249 ns` x `10,000` deveria ser `12,490,000 ns` e n√£o `110,879,642 ns` ü§Ø
Embora meu c√≥digo da sequ√™ncia de Fibonacci esteja funcionalmente correto, devo ter um bug de desempenho em algum lugar.

<FizzBuzzFibonacciFix />

Agora, vamos rodar esses benchmarks novamente e ver como fomos:

<BenchmarkGameFixOutput />

Oh, uau! Nosso benchmark `BENCHMARK_game` voltou para pr√≥ximo do original FizzBuzz.
Gostaria de lembrar exatamente qual era aquela pontua√ß√£o. J√° se passaram tr√™s semanas entretanto.
Meu hist√≥rico do terminal n√£o vai t√£o atr√°s, e o Google Benchmark n√£o armazena seus resultados.
Mas acho que est√° pr√≥ximo!

O benchmark `BENCHMARK_game_100` caiu quase 50x para `34.4 ns`.
E o benchmark `BENCHMARK_game_1_000_000` caiu mais de 1.500.000x! De `110,879,642 ns` para `61.6 ns`!

> üê∞ Ei, pelo menos pegamos esse bug de desempenho antes que chegasse √† produ√ß√£o... ah, certo. Deixa pra l√°...

<CatchInCi />

<CatchInCiOutput />

<CatchInCiPlot />

<CatchInCiPlotRustBench title="Como fazer Benchmark em C++ com Google Benchmark" />

<BencherFooter />