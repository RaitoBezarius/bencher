import TestbedCreate from "../testbed-create.mdx";
import GitCheckoutMain from "../git-checkout-main.mdx";
import RunMainRelative from "../run-main-relative.mdx";
import ThresholdCreateRelative from "../threshold-create-relative.mdx";
import GitCheckoutFeature from "../git-checkout-feature.mdx";
import RunFeatureRelative from "../run-feature-relative.mdx";

## Benchmarking Continu Relatif

Poursuivant l√† o√π nous nous √©tions arr√™t√©s dans les tutoriels
[D√©marrage Rapide][quick start] et [Auto-h√©bergement Docker][docker self-hosted],
ajoutons le Benchmarking Continu Relatif √† notre projet `Save Walter White`.

> üê∞ Assurez-vous d'avoir
> [cr√©√© un jeton API et de l'avoir configur√© comme la variable d'environnement `BENCHER_API_TOKEN`][create an api token]
> avant de continuer !

Tout d'abord, nous devons cr√©er un nouveau Testbed pour repr√©senter nos ex√©cutants CI, judicieusement nomm√© `ci-runner`.

<TestbedCreate />

1. Utilisez la sous-commande CLI `bencher testbed create`.
   Consultez [la doc `testbed create`][testbed create] pour plus de d√©tails.
   (ex: `bencher testbed create`)
2. D√©finissez l'option `--name` au nom de Testbed souhait√©.
   (ex: `--name ci-runner`)
3. Sp√©cifiez l'argument projet comme le slug du projet `Save Walter White`.
   (ex: `save-walter-white-1234abcd`)

Le Benchmarking Continu Relatif ex√©cute une comparaison c√¥te √† c√¥te de deux versions de votre code.
Cela peut √™tre utile lorsqu'on traite avec des environnements CI/CD bruyants,
o√π les ressources disponibles peuvent √™tre tr√®s variables entre les ex√©cutions.
Dans cet exemple, nous comparerons les r√©sultats de l'ex√©cution sur la branche `main`
aux r√©sultats de l'ex√©cution sur une branche de fonctionnalit√© nomm√©e `feature-branch`.
Comme chaque environnement CI est un peu diff√©rent,
l'exemple suivant est plus illustratif que pratique.
Pour des exemples plus sp√©cifiques, voir [Benchmarking Continu dans GitHub Actions][github actions]
et [Benchmarking Continu dans GitLab CI/CD][gitlab ci/cd].

Tout d'abord, nous devons passer √† la branche `main` avec `git` dans CI:

<GitCheckoutMain />

Puis nous devons ex√©cuter nos benchmarks sur la branche `main` dans CI:

<RunMainRelative />

1. Utilisez la sous-commande CLI <code><a href="/fr/docs/explanation/bencher-run/">bencher run</a></code>
   pour ex√©cuter vos benchmarks de la branche `main`.
   Consultez [la sous-commande CLI `bencher run`][bencher run] pour un aper√ßu complet.
   (ex: `bencher run`)
2. D√©finissez l'option `--project` au slug du projet.
   Consultez [la doc `--project`][project option] pour plus de d√©tails.
   (ex: `--project save-walter-white-1234abcd`)
3. D√©finissez l'option `--branch` au nom de la branche de fonctionnalit√©.
   Consultez [la s√©lection de branche][branch selection branch] pour un aper√ßu complet.
   (ex: `--branch feature-branch`)
4. D√©finissez le drapeau `--branch-reset`.
   Consultez [la s√©lection de branche][branch selection reset] pour un aper√ßu complet.
   (ex: `--branch-reset`)
5. D√©finissez l'option `--testbed` au nom du Testbed.
   Consultez [la doc `--tested`][testbed option] pour plus de d√©tails.
   (ex: `--testbed ci-runner`)
6. D√©finissez l'option `--adapter` √† l'adaptateur de harnais de benchmark souhait√©.
   Consultez [les adaptateurs de harnais de benchmark][adapters] pour un aper√ßu complet.
   (ex: `--adapter json`)
7.  Sp√©cifiez les arguments de la commande de benchmark.
    Consultez [la commande de benchmark][command argument] pour un aper√ßu complet.
    (ex: `bencher mock`)

La premi√®re fois que cette commande est ex√©cut√©e dans CI,
elle cr√©era la branche `feature-branch` puisqu'elle n'existe pas encore.
La nouvelle `feature-branch` n'aura pas de point de d√©part, de donn√©es existantes, ou de Seuils.
Lors des ex√©cutions ult√©rieures, l'ancienne version de `feature-branch` sera renomm√©e
et une nouvelle `feature-branch` sera cr√©√©e sans point de d√©part, de donn√©es existantes, ou de Seuils.

Ensuite, nous devons cr√©er un nouveau [Seuil][thresholds] dans CI pour notre nouvelle branche `feature-branch`:

<ThresholdCreateRelative />

1. Utilisez la sous-commande CLI `bencher threshold create`.
   Consultez [la doc `threshold create`][threshold create] pour plus de d√©tails.
   (ex: `bencher threshold create`)
2. D√©finissez l'option `--branch` √† la nouvelle branche `feature-branch`.
   (ex: `--branch feature-branch`)
3. D√©finissez l'option `--testbed` au Testbed `ci-runner`.
   (ex: `--testbed ci-runner`)
4. D√©finissez l'option `--measure` √† la mesure `Latency` int√©gr√©e qui est g√©n√©r√©e par `bencher mock`.
   Consultez [la d√©finition de Measure][measure] pour les d√©tails.
   (ex: `--measure Latency`)
5. D√©finissez l'option `--test` √† un seuil de `percentage`.
   Consultez [Seuils & Alertes][percentage] pour un aper√ßu complet.
   (ex: `--test t-test`)
6. D√©finissez l'option `--upper-boundary` √† une Limite Sup√©rieure de `0.25` (soit `25%`).
   Consultez [Seuils & Alertes][percentage upper boundary] pour un aper√ßu complet.
   (ex: `--upper-boundary 0.25`)
7. Sp√©cifiez l'argument projet comme le slug du projet `Save Walter White`.
   (ex: `save-walter-white-1234abcd`)

Ensuite, nous devons passer √† la branche `feature-branch` avec `git` dans CI:

<GitCheckoutFeature />

Enfin, nous sommes pr√™ts √† ex√©cuter nos benchmarks `feature-branch` dans CI:

<RunFeatureRelative />

1. Utilisez la sous-commande CLI <code><a href="/fr/docs/explanation/bencher-run/">bencher run</a></code>
   pour ex√©cuter vos benchmarks de la branche `feature-branch`.
   Consultez [la sous-commande CLI `bencher run`][bencher run] pour un aper√ßu complet.
   (ex: `bencher run`)
2. D√©finissez l'option `--project` au slug du projet.
   Consultez [la doc `--project`][project option] pour plus de d√©tails.
   (ex: `--project save-walter-white-1234abcd`)
3. D√©finissez l'option `--branch` au nom de la branche de fonctionnalit√©.
   Consultez [la s√©lection de branche][branch selection branch] pour un aper√ßu complet.
   (ex: `--branch feature-branch`)
4. D√©finissez l'option `--testbed` au nom du Testbed.
   Consultez [la doc `--tested`][testbed option] pour plus de d√©tails.
   (ex: `--testbed ci-runner`)
5. D√©finissez l'option `--adapter` √† l'adaptateur de harnais de benchmark souhait√©.
   Consultez [les adaptateurs de harnais de benchmark][adapters] pour un aper√ßu complet.
   (ex: `--adapter json`)
6. D√©finissez le drapeau `--err` pour √©chouer la commande si une Alerte est g√©n√©r√©e.
   Consultez [Seuils & Alertes][alerts] pour un aper√ßu complet.
   (ex: `--err`)
7. Sp√©cifiez les arguments de la commande de benchmark.
   Consultez [la commande de benchmark][command argument] pour un aper√ßu complet.
   (ex: `bencher mock`)

Chaque fois que cette commande est ex√©cut√©e dans CI,
elle compare les r√©sultats de `feature-branch` uniquement aux r√©sultats les plus r√©cents de `main`.

[quick start]: /fr/docs/tutorial/quick-start/
[docker self-hosted]: /fr/docs/tutorial/docker/
[continuous benchmarking]: /fr/docs/explanation/continuous-benchmarking/
[create an api token]: /fr/docs/tutorial/quick-start/#create-an-api-token
[testbed create]: /fr/docs/api/projects/testbeds/#post-v0projectsprojecttestbeds
[github actions]: /fr/docs/how-to/github-actions/
[gitlab ci/cd]: /fr/docs/how-to/gitlab-ci-cd/
[bencher run]: /fr/docs/explanation/bencher-run/
[project option]: /fr/docs/explanation/bencher-run/#--project-project
[branch selection branch]: /fr/docs/explanation/branch-selection/#--branch-branch
[branch selection reset]: /fr/docs/explanation/branch-selection/#--branch-reset
[testbed option]: /fr/docs/explanation/bencher-run/#--testbed-testbed
[adapters]: /fr/docs/explanation/adapters/
[command argument]: /fr/docs/explanation/bencher-run/#benchmark-command
[thresholds]: /fr/docs/explanation/thresholds/
[threshold create]: /fr/docs/api/projects/thresholds/#post-v0projectsprojectthresholds
[measure]: /fr/docs/explanation/benchmarking/#measure
[percentage]: /fr/docs/explanation/thresholds/#percentage-thresholds
[percentage upper boundary]: /fr/docs/explanation/thresholds/#percentage-threshold-upper-boundary
[alerts]: /fr/docs/explanation/thresholds/#alerts