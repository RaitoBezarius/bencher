### Фреймворк HTTP-сервера

Одним из важнейших факторов при выборе фреймворка HTTP-сервера на Rust для меня была поддержка встроенной [спецификации OpenAPI][openapi spec]. По тем же причинам, что я инвестировал в установку [Typeshare и WASM на фронтенде][frontend language], я хотел иметь возможность автоматически генерировать как документацию API, так и клиентов из этой спецификации. Для меня было важно, чтобы эта функциональность была встроенной, а не сторонним дополнением. Чтобы автоматизация действительно стоила того, она должна работать почти на 100% времени. Это означает, что бремя поддержки и совместимости должно лежать на самих инженерах основного фреймворка. В противном случае вы неизбежно окажетесь в адских граничных ситуациях.

Еще одним ключевым фактором было риск заброшенности. Существует несколько когда-то многообещающих фреймворков HTTP на Rust, которые теперь практически заброшены. Единственным фреймворком, который я нашел с поддержкой встроенной спецификации OpenAPI и на который я был готов поставить, был [Dropshot][dropshot github]. Dropshot был создан и поддерживается [Oxide Computer][oxide computer].

Пока у меня была только одна серьезная проблема с Dropshot. Когда сервер API генерирует ошибку, на фронтенде происходит сбой CORS из-за отсутствия заголовков ответа. Это означает, что веб-фронтенд не может показывать пользователям очень полезные сообщения об ошибках. Вместо того чтобы заниматься исправлением на upstream, я сосредоточил свои усилия на том, чтобы сделать Bencher более простым и интуитивно понятным в использовании. Но, как оказалось, решение [занимает менее 100 строк кода][dropshot github issue 1193]. Вот так повезло!

К слову, [фреймворк `axum`][axum github] еще не был выпущен, когда я начал работать над Bencher. Если бы он был тогда доступен, возможно, я бы попытался совместить его с одним из множества сторонних дополнений OpenAPI, несмотря на мой здравый смысл. К счастью, `axum` тогда еще не существовал, чтобы меня соблазнить. Dropshot оказался отличным выбором. См. раздел [Клиент API][api client] для получения дополнительной информации по этому вопросу.

> | Технология | Вывод |
> | :--------: | :---: |
> |  Dropshot  |   ✅   |

[openapi spec]: https://swagger.io/specification/
[frontend language]: #frontend-language
[dropshot github]: https://github.com/oxidecomputer/dropshot
[oxide computer]: https://oxide.computer/
[dropshot github issue 1193]: https://github.com/oxidecomputer/dropshot/pull/1193
[axum github]: https://github.com/tokio-rs/axum
[api client]: #api-client
