### `plus.disaster_recovery`

Этот раздел описывает конфигурацию восстановления после аварий.
Bencher поддерживает непрерывное реплицирование всех изменений базы данных.
Для выполнения резервных копий по запросу или по расписанию, см. раздел конфигурации `database.data_store`.

Существует четыре схемы репликации:
- `file`: Реплицирование в локальную файловую систему
    - `path`: Путь для репликации
- `sftp`: Реплицирование по SFTP
    - `host`: Имя хоста целевой системы
    - `port`: Номер порта целевой системы
    - `user`: Имя пользователя на целевой системе
    - `password`: (Опционально) Пароль на целевой системе
    - `path`: (Опционально) Путь на целевой системе
    - `key_path`: (Опционально) Путь к SSH ключу
- `s3`: Реплицирование в любое совместимое S3 хранилище
    - `bucket`: Имя bucket
    - `path`: (Опционально) Путь в bucket
    - `endpoint`: (AWS: Опционально | Не AWS: Обязательно) Конечная точка репликации
    - `region`: (Опционально) Регион bucket
    - `access_key_id`: Ключ доступа S3
    - `secret_access_key`: Секретный ключ доступа S3
- `abs`: Реплицирование в Azure Blob Storage
    - `account_name`: Имя учетной записи
    - `bucket`: Имя bucket
    - `path`: (Опционально) Путь в bucket
    - `account_key`: Ключ учетной записи Azure
- `gcs`: Реплицирование в Google Cloud Storage
    - `bucket`: Имя bucket
    - `path`: (Опционально) Путь в bucket
    - `GOOGLE_APPLICATION_CREDENTIALS`: Переменная окружения, указывающая на путь к файлу с учетными данными сервисного аккаунта

Все четыре схемы репликации имеют следующие дополнительные опции:

- `retention`: (Опционально) Время, в течение которого будут сохраняться файлы snapshot и WAL. По истечении этого времени будет создан новый snapshot, а старый будет удален. Файлы WAL, которые существуют до самого старого snapshot, также будут удалены. Значение по умолчанию: `24h`.
- `retention_check_interval`: (Опционально) Указывает, как часто Bencher будет проверять необходимость применения политики retention. Значение по умолчанию: `1h`.
- `snapshot_interval`: (Опционально) Указывает, как часто будут создаваться новые snapshots. Это используется для уменьшения времени восстановления, так как новые snapshots будут содержать меньшее количество WAL кадров для применения. Политика retention также применяется к этим snapshots. Если вы не указываете интервал создания snapshot, то новый snapshot будет создан при каждом выполнении retention. По умолчанию retention выполняется каждые 24 часа.
- `validation_interval`: (Опционально) Если указано, Bencher автоматически восстановит и проверит, что данные на реплике соответствуют локальной копии. По умолчанию отключено. Включение этой функции может значительно увеличить стоимость запуска Bencher, так как большинство облачных сервисов взимают плату за загрузки.
- `sync_interval`: (Опционально) Частота, с которой кадры передаются на реплику. Значение по умолчанию: `1s`. Увеличение частоты может значительно повысить затраты на облачное хранилище.

|           Имя            |  Пример   | По умолчанию | Обязательно |                                     Описание                                     |
| :----------------------: | :-------: | :----------: | :---------: | :------------------------------------------------------------------------------: |
|       busy_timeout       |   5000    |     5000     |     Нет     |          Указывает тайм-аут занятости для базы данных в миллисекундах.           |
|         replicas         |  [ ... ]  |     ---      |     Да      |                             Указывает массив реплик.                             |
|    replicas[replica]     | \{ ... \} |     ---      |     Да      |                            Указывает объект реплики.                             |
| replicas[replica].scheme |   "s3"    |     ---      |     Да      | Указывает схему репликации. Для всех остальных ключей `replica` см. список выше. |