import ShellForm from "../shell-form.mdx";
import ExecForm from "../exec-form.mdx";

## Команда для бенчмаркинга

Первым аргументом для `bencher run` является необязательная команда бенчмаркинга.
Это команда, которая будет выполнена для вызова вашего механизма бенчмаркинга.
Также её можно задать с помощью переменной окружения `BENCHER_CMD`.
По умолчанию эта команда выполняется в оболочке,
которую можно настроить с помощью опций [`--shell`][shell option] и [`--flag`][flag option].
Её вывод анализируется [адаптером механизма бенчмаркинга][benchmark harness adapters],
который можно задать с помощью опции [`--adapter`][adapter option].
Однако, если механизм бенчмаркинга выводит результаты в файл, то должна быть также использована опция [`--file`][file option],
чтобы указать путь к файлу вывода.
В качестве альтернативы для отслеживания размера файла вывода (например, размера бинарного файла) вместо его содержимого,
можно использовать опцию [`--file-size`][file size option], чтобы указать путь к файлу вывода.

Если вы предпочитаете не выполнять команду в оболочке, вы можете использовать флаг `--exec` или просто предоставить дополнительные аргументы к вашей команде как дополнительные аргументы к `bencher run`.

Форма Shell:
<ShellForm />

Форма Exec:
<ExecForm />

Команду для бенчмаркинга можно выполнить несколько раз, используя опцию [`--iter`][iter option],
и эти результаты можно объединить в один результат с помощью опции [`--fold`][fold option].
Если какая-либо из итераций не удастся, то вся команда считается неудачной,
если только не установлен флаг [`--allow-failure`][allow failure flag].

Если команда для бенчмаркинга не указана, но указана опция [`--file`][file option],
то `bencher run` просто будет читать из пути файла вывода.
Аналогичным образом, если команда для бенчмаркинга не указана, но указана опция [`--file-size`][file size option],
то `bencher run` будет читать размер файла по указанному пути файла.
Если не указана команда для бенчмаркинга, опция [`--file`][file option],
ни опция [`--file-size`][file size option],
то `bencher run` будет читать из `stdin`.
Это позволяет вам сохранить вывод другой команды в файл или перенаправить его в `bencher run`.

[benchmark harness adapters]: /ru/docs/explanation/adapters/

[shell option]: #--shell-shell
[flag option]: #--flag-flag
[adapter option]: #--adapter-adapter
[file option]: #--file-file
[file size option]: #--file-size-file
[iter option]: #--iter-iter
[fold option]: #--fold-fold
[allow failure flag]: #--allow-failure