import ShellForm from "../shell-form.mdx";
import ExecForm from "../exec-form.mdx";

## ベンチマークコマンド

`bencher run`への最初の引数は、オプションのベンチマークコマンドです。
これは実行されるコマンドで、ベンチマークハーネスを呼び出します。
`BENCHER_CMD`環境変数を使用して設定することもできます。
デフォルトではこのコマンドはシェルで実行され、[`--shell`][shell option] オプションと [`--flag`][flag option] オプションで設定することができます。
その出力は[ベンチマークハーネスアダプター][benchmark harness adapters]によって解析され、[`--adapter`][adapter option] オプションを使用して設定します。
しかし、ベンチマークハーネスがファイルに出力する場合は、出力ファイルのパスを指定するためにも[`--file`][file option] オプションを使用しなければなりません。
出力ファイルのサイズ（つまりバイナリサイズ）をその内容の代わりに追跡するためには、出力ファイルのパスを指定する[`--file-size`][file size option] オプションを使用します。

コマンドをシェルで実行したくない場合は、`--exec` フラグを使用するか、追加の引数を `bencher run` への追加の引数として提供することができます。

Shell Form:
<ShellForm />

Exec Form:
<ExecForm />

[`--iter`][iter option] オプションを使用してベンチマークコマンドを複数回実行し、[`--fold`][fold option] オプションを使用してそれらの結果を単一の結果にまとめることができます。
いずれかの反復が失敗した場合、[`--allow-failure`][allow failure flag] フラグが設定されていない限り、コマンド全体が失敗とみなされます。

ベンチマークコマンドが指定されていないが[`--file`][file option] オプションが指定されている場合、`bencher run`は代わりに出力ファイルパスから読み取ります。
同様に、ベンチマークコマンドが指定されていないが[`--file-size`][file size option] オプションが指定されている場合、`bencher run`は指定されたファイルパスのファイルサイズを読み取ります。
ベンチマークコマンド、[`--file`][file option] オプション、[`--file-size`][file size option] オプションのいずれも指定されていない場合、`bencher run`は代わりに `stdin` から読み取ります。
これにより、他のコマンドの出力をファイルに保存するか、`bencher run`にパイプすることができます。

[benchmark harness adapters]: /ja/docs/explanation/adapters/

[shell option]: #--shell-shell
[flag option]: #--flag-flag
[adapter option]: #--adapter-adapter
[file option]: #--file-file
[file size option]: #--file-size-file
[iter option]: #--iter-iter
[fold option]: #--fold-fold
[allow failure flag]: #--allow-failure